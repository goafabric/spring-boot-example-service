#!/bin/bash
source .values

export COMMAND=$1

if [ "${COMMAND}" = "up" ]
then
    kubectl create configmap country-service-postgres-initdb --from-file=./config/initdb/ -n ${NAMESPACE}
    kubectl apply -f ./templates/ -n ${NAMESPACE}
    kubectl apply -f ./templates/pvc -n ${NAMESPACE}
elif [ "${COMMAND}" = "down" ]
then
    kubectl delete --ignore-not-found configmap country-service-postgres-initdb -n ${NAMESPACE}
    kubectl delete --ignore-not-found -f ./templates/ -n ${NAMESPACE}
elif [ "${COMMAND}" = "prov" ]
then
    ./stack up
elif [ "${COMMAND}" = "prune" ]
then
    ./stack down
    kubectl delete --ignore-not-found -f ./templates/pvc -n ${NAMESPACE}
else
    echo Doing nothing !
fi
